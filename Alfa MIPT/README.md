# Alfa-MIPT

<img src="https://raw.githubusercontent.com/akscent/kaggle-competitions/main/Alfa%20MIPT/img/banner.PNG">

# Описание задачи
Одной из задач в любом банке является эффективное распределение наличных денежных средств, в том числе и в банкоматах. Оптимальная загрузка АТМ позволяет экономить на фондировании, в противном случае банк теряет деньги из-за простоя лишних денежных купюр.

Но для того, чтобы знать, сколько денег нужно держать в банкомате, нужно уметь прогнозировать спрос на выдачу на несколько дней вперёд.

В этом конкурсе предлагается научиться предсказывать выдачу денег в АТМ в горизонте 14 дней.

**Полезная информация**

Для конкурса предоставлены данные по ресайклинговым АТМ. Основное отличие таких АТМ от остальных заключается в отсутствии разбиения кассет на приём и выдачу наличных: куппюра, которая попала в АТМ может быть выдана при следующей операции.
Так же все АТМ расположены в свободном доступе (ТЦ, магазины, отделения) в городах миллионниках, не являясь зарплатными.

[BaseLine](https://www.kaggle.com/code/evgeniigavrilin/baseline)

# Решение

> Базовым решением было использование тематической библиотеки `etna` с различными трансформациями в качестве предикторов. Кроме того, я разделил наборы временных рядов на высоко коррелирующие между собой, что позволило также использовать данные этих банкоматов в качестве предикторов.

<img src="https://raw.githubusercontent.com/akscent/kaggle-competitions/main/Alfa%20MIPT/img/correl.PNG">

> В ходе анализа было выяснено, что модель, обученная на всех рядах, будет работать хуже в предсказании будущей динамики, поэтому обучение моделей производилось отдельно для каждого банкомата с использованием модели `CatBosstPerSegment`. 

> Помимо прочего, временные ряды обалдали разной продолжительностью и разными гэпами, в связи с чем они были разделены на 3 группы: краткосрочные, среднесрочные и долгосрочные. В зависимости от группы, набор редикторов разнился.

<img src="https://raw.githubusercontent.com/akscent/kaggle-competitions/main/Alfa%20MIPT/img/groups.PNG">

# Результат
Результатом были следующие 14-дневные предсказания и 10 позиция в лидерборде.

<img src="https://raw.githubusercontent.com/akscent/kaggle-competitions/main/Alfa%20MIPT/img/ts.PNG">

<img src="https://raw.githubusercontent.com/akscent/kaggle-competitions/main/Alfa%20MIPT/img/sub.PNG">